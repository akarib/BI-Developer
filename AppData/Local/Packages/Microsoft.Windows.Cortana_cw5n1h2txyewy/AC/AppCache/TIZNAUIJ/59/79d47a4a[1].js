var AutoSuggest;(function(n){var t;(function(t){function c(n){return n.toLocaleLowerCase().replace(a,"").trim()}function l(n,t,i,r,u){if(!n)return i;if(typeof n!="string")try{return{content:URL.createObjectURL(n),type:0,bgColor:r}}catch(f){return SharedLogHelper.LogError("convertToHtmlImage "+t,u,f),i}else return{content:n,type:0,bgColor:r}}function o(n,t){var i=parseInt(n.substr(1),16),r=i>>16&255,u=i>>8&255,f=i&255;return"rgba("+r+","+u+","+f+","+t+")"}function y(n,t){var i=parseInt(n.substr(1),16),r=Math.max(0,(i>>16)-t),u=Math.max(0,(i>>8&255)-t),f=Math.max(0,(i&255)-t);return"#"+String("000000"+(f|u<<8|r<<16).toString(16)).slice(-6)}function s(n,t){var i=parseInt(n.substr(1),16),r=Math.max(0,(i>>16)*t),u=Math.max(0,(i>>8&255)*t),f=Math.max(0,(i&255)*t);return"#"+String("000000"+(f|u<<8|r<<16).toString(16)).slice(-6)}var i,e,r,u,f,a=/[\.,:;?!¿¡]/g,h=-933981677285477,v=400;t.toIcon=l;var p={"action://Help/Launch":t.config.htmlHelpCanvas?"Help":"SpeechHelp","ms-cortana://navigate/Notebook":"Notebook"},w={"ms-cortana://navigate/Settings":t.config.settingsUri},b=function(){function a(o){var s=this;this._accessTokenManager=o;this._queryParamsCache={};this._locStrings=[];this._enUsLocStrings=[];this._modifierKeyState={altKey:!1,ctrlKey:!1,shiftKey:!1};this._appVisibleEventHandlers=[];this._shownEventHandlers=[];this._conversationStartEventHandlers=[];this._dismissedEventHandlers=[];this._appHiddenEventHandlers=[];this._searchBoxGotFocusEventHandlers=[];this._searchBoxLostFocusEventHandlers=[];this._onSubmitHandlers=[];this._onSearchBoxGlyphIconClick=[];this._onSearchBoxClick=[];this._onButtonRightOfSearchBoxClick=[];this._queryChangedHandlers=[];this._rawQueryChangedHandlers=[];this._keyDownHandlers=[];this._keyUpHandlers=[];this._accessTokenAvailableHandlers=[];this._state=0;this._pinnedApps={};this._paneCloseCount=0;this._qfDismissCount=0;this._currentPaneHeight=0;this._root=_ge("root");this.usedImpressionIds={};this.getEdgeIcon=function(n,t){return s._edgeIconCache(n,t)};this._suggestionsContainer=_ge("suggestionsList");n.safeExecute(function(){var c,o;i=SearchAppWrapper.CortanaApp;e=i.queryFormulationView;r=i.launcher;u=i.searchBox;f=n.Service.QueryParams;n.refreshBingEnabledCache(i.isBingEnabled,t.getMarketForBingAvailability());s._currentCVID=n.cleanGuid(s.createGuid());s._randomPrivacyNumber=s.getNewPrivacyNumber();s.initLanguage();c=n.safeExecute(function(){return+e.perfMetrics.lookup(32)},"perfMetricsFallbackLookup",h);s._hasFallbackHappened=c!=h;o=e.searchHistory;o?o.addEventListener("cleardevicehistoryrequested",function(){n.log("clearDeviceHistoryRequested");var t=function(t){return n.safeExecute(function(){n.log(t?"clearDeviceHistory succeded":"clearDeviceHistory failed");o.signalClearDeviceHistoryCompleted(t)},"signalClearDeviceHistoryCompleted")};s._clearStorageRequestedEventHandler?(n.log("calling clearDeviceHistoryRequested handler"),n.safeExecute(function(){return s._clearStorageRequestedEventHandler(t),!0},"clearDeviceHistoryRequested")||t(!1)):(n.log("no handler for clearDeviceHistoryRequested"),t(!1))}):n.log("searchHistory not available");i.addEventListener("statechanged",function(n){return s.updateState(s._state,n.newState,!1)});u.addEventListener("querytextchanged",function(n){var t=n.queryText;s._queryPropertiesOverrides&&s._queryPropertiesOverrides.query!=t&&(s._queryPropertiesOverrides=null);s.updateState(s._state,2,!0);s._queryToIgnoreOnQueryTextChangedEvent!=n.queryText&&(s._queryToIgnoreOnQueryTextChangedEvent=null);s.callQueryChangedHandlers(n,!1,s._queryToIgnoreOnQueryTextChangedEvent!=null,n.impressionId)});u.addEventListener("keydown",function(i){var f=i.keyCode,e={shiftKey:i.isShiftKeyPressed,ctrlKey:i.isControlKeyPressed,altKey:!1},r,u;t.config.searchBoxFocusEvents||(r=n.getCurrentActiveElement(),r&&!t.isBodyOrSuggestion(r)&&r.blur());u=i.isHandled;s._keyDownHandlers.forEach(function(t){return n.safeExecute(function(){return t(f,e,u)},"keyDown")})});sj_b.addEventListener("keydown",function(i){var u=i.keyCode,f=i.target,h=t.alwaysWide||t.config.enableLocalPreviewPaneInSingleColumn,e,o,r;if(i.target){if(e=_ge("fbpgdg"),e&&e.contains(f))return;if(u==13&&f.classList.contains("dropDownButton"))return;if(f.classList.contains("menuItem")){sj_pd(i);return}if(!h&&t.previewPaneAvailable&&(r=_ge("qfPreviewPane"),r&&r.contains(f)))if(u==37)sj_pd(i);else return}if(n.contains([38,40],u)&&sj_pd(i),s.isRequestFocusAvailable()&&!t.config.allowUpForScopes){if(u==13)return;n.contains([38,40],u)&&(o=!0,h&&(r=_ge("qfPreviewPane"),o=!r||!r.contains(f)),o&&s.setFocusInSearchBox("keyDown"))}s._keyDownHandlers.forEach(function(t){return n.safeExecute(function(){return t(i.keyCode,i)},"body.keyDown")})});u.addEventListener("keyup",function(t){var i=t.keyCode,r={shiftKey:t.isShiftKeyPressed,ctrlKey:t.isControlKeyPressed,altKey:!1},u=t.isHandled;s._keyUpHandlers.forEach(function(t){return n.safeExecute(function(){return t(i,r,u)},"keyUp")})});sj_b.addEventListener("keyup",function(t){return s._keyUpHandlers.forEach(function(i){return n.safeExecute(function(){return i(t.keyCode,t)},"keyUp")})});u.addEventListener("gotfocus",function(){return s._searchBoxGotFocusEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"gotfocus")})});u.addEventListener("lostfocus",function(){return s._searchBoxLostFocusEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"lostfocus")})});u.addEventListener("submitbuttonclick",function(){var r=n.getCurrentTime(),i=s.getFeatureString("SubmitButtonGlyph").featureValue;i&&i!=""||t.qfMode==2?s._onButtonRightOfSearchBoxClick.forEach(function(t){return n.safeExecute(function(){return t(i)},"submitbuttonclick.custom")}):s._onSubmitHandlers.forEach(function(t){return n.safeExecute(function(){return t(r,!0,null)},"submitbuttonclick")})});u.addEventListener("searchboxglyphclick",function(){return s._onSearchBoxGlyphIconClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxglyphclick")})});u.addEventListener("searchboxtapped",function(){return s._onSearchBoxClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxtapped")})});u.addEventListener("searchboxclick",function(){return s._onSearchBoxClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxclick")})});sj_evt.bind("ajax.feedback.initialized",function(){return s.registerFeedbackDebugCallback},!0)},"WindowsHostInit");this.bindAppVisible(function(){return s.appVisibleInit()});this.bindShown(function(){n.safeFireEvent("ajax.threshold.pageStart",n.getCurrentTime());s.shownInit();var t=s.getNewConversationId();s._currentCVID!=t&&(s._currentCVID=t,s._randomPrivacyNumber=s.getNewPrivacyNumber(),s._conversationStartEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"conversationStart")}));s._lastKeyWasEnter=!1});this.bindDismissed(function(){s._qfDismissCount+=1;n.safeFireEvent("WindowsFeedback.Form.Hide");n.safeFireEvent("threshold.pageUnload");s.dismissCleanup()});this.bindAppHidden(function(){s._paneCloseCount+=1;s.appHiddenCleanup();s.uploadClientErrorLog()});this.bindKeyDown(function(r,f){var e,o;s._modifierKeyState=f;e=r==13;e&&!s._lastKeyWasEnter&&(o=n.getCurrentTime(),s._onSubmitHandlers.forEach(function(t){return n.safeExecute(function(){return t(o,!1,f)},"onSubmit handlers")}));s._lastKeyWasEnter=e;r==27&&(t.qfMode==3||t.qfMode==2)&&(u.getQueryText().queryText?n.safeExecute(function(){return u.setQueryText("",!0)},"setQueryText"):n.safeExecute(function(){return i.dismissApp()},"dismissApp"))});this.bindKeyUp(function(n){s._lastKeyWasEnter=!1;switch(n){case 16:s._modifierKeyState.shiftKey=!1;break;case 17:s._modifierKeyState.ctrlKey=!1}});_G.PN="QF";this._edgeIconCache=t.Promise.safeChainWithGlobalCaching("edgeIcon",function(n){return e.deviceSearch.findAppsAsync([t.EdgeAppId]).then(function(i){var r=i[t.EdgeAppId];return r.getImageAsync(t.getImageSizeValue(n)).then(function(n){return l(n,"edgeIcon",null,r.logoBackgroundColor)})})},function(n){return n+"_edgeIcon"});!t.isMobileCache&&i.setDefaultUriLaunchPolicy&&i.setDefaultUriLaunchPolicy(2);sj_evt.bind("onFeedbackStarting",function(){s._feedbackFormIsVisible=!0;s.adjustHeight()});sj_evt.bind("onFeedbackClosing",function(){s._feedbackFormIsVisible=!1;s.adjustHeight()});this.enumerateMultiAccountAuthority(this._qfDismissCount)}return a.prototype.uploadClientErrorLog=function(){var o,u,e,t,f,r;if(i.getFlightingLogsAndDelete)for(o=n.safeExecute(function(){return i.getFlightingLogsAndDelete()},"getFlightingLogsAndDelete",""),u=0,e=o.split("\r\n");u<e.length;u++)t=e[u],t!=""&&(f=t.indexOf("|"),f<0||f+1==t.length?SharedLogHelper.LogWarning("clientError",t,"Malformed clientError data"):(r=t.substr(f+1),r.startsWith("Critical:")||r.startsWith("Error:")?SharedLogHelper.LogError("clientError",null,r):SharedLogHelper.LogWarning("clientError",null,r)))},a.prototype.registerFeedbackDebugCallback=function(n){var t=this,i=n[1].debugCollector;i.registerCollectionCallback(function(){return t.collectDebugInfo()})},a.prototype.collectDebugInfo=function(){var n={},u=this._currentQuery&&this._currentQuery.originalQuery,t,r;return u&&(n.query=u),n.conversationId=this._currentCVID,n.entryPoint=i.entryPoint,n.previousExperience=e.previousExperience,t=i.width,t&&(n.width=t.toString()),r=i.height,r&&(n.height=r.toString()),n},a.prototype.clearInitialFetchTimer=function(){this._initialFetchTimer&&(sb_ct(this._initialFetchTimer),this._initialFetchTimer=null)},a.prototype.callQueryChangedHandlers=function(t,r,u,f){var o=this.getStructuredQuery(t,this._currentQuery),e;(this._rawQueryChangedHandlers.forEach(function(t){return n.safeExecute(function(){return t(o,r)},"rawQueryTextChanged")}),u||this.clearInitialFetchTimer(),f||(e=i.impressionId,this.usedImpressionIds[e]||(f=e,this.usedImpressionIds[e]=!0)),f&&f!=this._currentRawImpressionId?(this._currentRawImpressionId=f,this._currentRawImpressionIdCreatedByTheClient=!0):(this._currentRawImpressionId=this.createGuid(),this._currentRawImpressionIdCreatedByTheClient=!1),u)||(this._previousQuery=this._currentQuery,this._currentQuery=o,this._queryChangedHandlers.forEach(function(t){return n.safeExecute(function(){return t(o,r)},"queryTextChanged")}))},a.prototype.getStructuredQuery=function(r,u){var e=r.queryText,o=this._queryPropertiesOverrides&&this._queryPropertiesOverrides.query==e,h=o?this._queryPropertiesOverrides.topHitRestriction:null,f=o&&t.isCortanaEnabledCache?this._queryPropertiesOverrides.taskFrame:null,c=o?this._queryPropertiesOverrides.forceGroupOnTop:null,l=o?this._queryPropertiesOverrides.overrideAction:null,s;return!f&&t.isCortanaEnabledCache&&i.searchResultsView.getTaskFrame&&(s=n.safeExecute(function(){return i.searchResultsView.getTaskFrame(e)},"getTaskFrame"),s&&(f=t.parseTaskFrame(s))),!f&&u&&u.taskFrame&&u.originalQuery==e&&(f=u.taskFrame),t.parseQuery(e,r.cursorPosition,u,f,h,c,l)},a.prototype.updateState=function(t,i,r){var f=this;t!=i&&(this._state=i,t==0&&this._appVisibleEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appVisible")}),i==2&&(this._shownEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"shown")}),r||(this._initialFetchTimer=sb_st(function(){return n.safeExecute(function(){return f.callQueryChangedHandlers(u.getQueryText(),!1,!1)},"initialFetch")},0))),t==2&&(this.clearInitialFetchTimer(),this._dismissedEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"dismissed")})),i==0&&this._appHiddenEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appHidden")}))},a.prototype.searchBoxHasFocus=function(){return!t.config.searchBoxFocusEvents||i.searchBox.hasFocus},a.prototype.initializeEvents=function(){this.updateState(this._state,i.currentState,!1)},a.prototype.bindClearMRURequested=function(n){this._clearStorageRequestedEventHandler&&SharedLogHelper.LogError("bindClearMRURequested",null,new Error("Only one event handler supported"));this._clearStorageRequestedEventHandler=n},a.prototype.shouldRequestEltoken=function(){return this._shouldRequestEltoken},a.prototype.getElToken=function(){return this._elToken},a.prototype.setElToken=function(n){this._elToken=n;this._shouldRequestEltoken=!1},a.prototype.canHaveSearchHistory=function(){return t.searchHistoryAllowed()},a.prototype.getInstrumentationParameters=function(n){var t=i.createStringMap?i.createStringMap():{};return _G.nclid&&(t[f.HashedMuid]=_G.nclid),t[f.FormCode]=n||this.getFormCode(),t[f.ConversationId]=this.getConversationId(),t},a.prototype.tryConnect=function(i,r,f){var e=this,o=i==1?t.isSubstrateO365AccountConnected:t.isSubstrateOutlookAccountConnected;o||this._accessTokenManager.getAccount(i,t.getSubstrateResourceOrScope(i),!1,!0,function(f){var o=!!f,s;i==1?t.isSubstrateO365AccountConnected=o:t.isSubstrateOutlookAccountConnected=o;o&&(e._accessTokenAvailableHandlers.forEach(function(t){return n.safeExecute(function(){return t(i)},"accessTokenAvailable",null,i.toString())}),s=i==1?function(n){return n.dataSource=="SSEE"||n.dataSource=="SSUE"}:function(n){return n.dataSource=="SSEC"||n.dataSource=="SSUC"},e._currentQuery&&r==e._qfDismissCount&&t.config.refreshWhenTokenArrives&&(e._currentQuery.queryToFetch.length>=t.config.minLengthFor3SonL1||t.isL2(e._currentQuery))&&e._currentQuery.originalQuery==u.getQueryText().queryText&&t.ScopeConfig[e._currentQuery.scope].enabledDataSources.some(s)&&e.refreshCurrentPane())},t.getAuthAccountForCloudContent(),f)},a.prototype.appHiddenCleanup=function(){t.Promise.clearGlobalCache();this._locStrings=[];t.cleanScopePrefixes();this.cleanTaskBarPinnedItems();t.clearPathExpansionCache()},a.prototype.initLanguage=function(){var r,u,e;t.uiLanguageCache=i.systemLanguage||i.uiLanguage;this.initCortanaEnabledAndRegion();t.homeGeographicRegionCache=i.homeGeographicRegion;this._queryParamsCache[n.Service.QueryParams.SetLang]=t.uiLanguageCache;var o=this._enUsLocStrings.length==0,s=function(i){var r={uiCulture:"en-US",name:i,namespace:"AutoSuggest"},u;o&&f._enUsLocStrings.push(LocStringManager.getLocString(r));t.uiLanguageCache.toLowerCase()!="en-us"&&(r.uiCulture=t.uiLanguageCache,u=n.safeExecute(function(){return LocStringManager.getLocString(r)},"getLocString",null,r.uiCulture),u&&f._locStrings.push(u))},f=this;for(r=0,u=t.config.locStrings;r<u.length;r++)e=u[r],s(e)},a.prototype.appVisibleInit=function(){var r=this,e=i.textScaleFactor>1.25,u,f;try{u=i.isWideSearch}catch(o){}f=u!==!1&&!!this.getFeatureDWORD("WideAtStartupDelta").featureValue;t.isAndromedaCache?(t.previewPaneAvailable=!1,t.qfMode=4,t.alwaysWide=!1,t.searchBoxOnTop=!0,t.scopesAvailable=!1,t.flatListWithoutGroups=!0,t.flatListWithoutGroupsZeroInput=!1,t.maxSuggestionsWhenFlatList=t.config.maxSuggestionsWhenFlatList,t.previewPaneAvailable=!1,t.zeroInputAvailable=!0,t.zeroInputHomeSupported=!1,t.setZeroInputDataSourcesForL1(!0)):i.hostingEnvironment==1||i.hostingEnvironment==3||t.config.tabShellInCoss&&i.isCenterScreen?(t.previewPaneAvailable=!1,t.qfMode=i.hostingEnvironment==3?5:3,t.alwaysWide=!1,t.searchBoxOnTop=!0,t.scopesAvailable=!1,t.flatListWithoutGroups=!0,t.flatListWithoutGroupsZeroInput=!0,t.maxSuggestionsWhenFlatList=t.config.maxSuggestionsWhenFlatList,t.zeroInputAvailable=!0,t.zeroInputHomeSupported=!1,t.setZeroInputDataSourcesForL1(!0)):i.isCenterScreen?(t.previewPaneAvailable=!0,t.qfMode=2,t.alwaysWide=!0,t.searchBoxOnTop=!0,t.scopesAvailable=t.config.scopesOrderBeginAlwaysWide.length>0,t.flatListWithoutGroups=!1,t.flatListWithoutGroupsZeroInput=t.config.enableFlatListImmersiveSearchZeroInput,t.maxSuggestionsWhenFlatList=t.config.maxSuggestionsImmersiveSearchZeroInput,t.zeroInputAvailable=!0,t.zeroInputHomeSupported=!1,t.setZeroInputDataSourcesForL1(!0)):(f||t.config.alwaysWideBeforeRS5)&&!e?(t.previewPaneAvailable=!0,t.qfMode=1,t.alwaysWide=!0,t.searchBoxOnTop=!1,t.scopesAvailable=t.config.scopesOrderBeginAlwaysWide.length>0,t.flatListWithoutGroups=!1,t.flatListWithoutGroupsZeroInput=!1,t.maxSuggestionsWhenFlatList=0,t.zeroInputAvailable=!0,t.zeroInputHomeSupported=!0,t.setZeroInputDataSourcesForL1(!1)):(t.previewPaneAvailable=t.PreviewPane&&!f&&u!==!1,t.qfMode=t.previewPaneAvailable?0:4,t.alwaysWide=!1,t.searchBoxOnTop=!1,t.scopesAvailable=t.config.scopesOrderBegin.length>0,t.flatListWithoutGroups=!1,t.flatListWithoutGroupsZeroInput=!1,t.maxSuggestionsWhenFlatList=0,t.zeroInputAvailable=t.config.startMenuInWSB,t.zeroInputHomeSupported=!0,t.setZeroInputDataSourcesForL1(!1));t.isCloudSearchEnabledCache=i.isCloudSearchEnabled!==!1;this.initLanguage();n.refreshBingEnabledCache(i.isBingEnabled,t.getMarketForBingAvailability());t.initScopePrefixes(function(n){return r.getLocString(n)},function(n){return r.getEnUsLocString(n)});t.scopeListRequiresUpdate=!0;this.populateTaskbarPinnedItemsAsync();this._suggestionsContainer.setAttribute("aria-label",this.getLocString("ResultsList"));this._elToken=null;ThresholdUtilities.getThemeColor(function(n){n!=r._accentColor&&(r._accentColor=n,r.applyAccentColor(n))});ThresholdUtilities.setBodyLangAttributes(t.uiLanguageCache)},a.prototype.shownInit=function(){var r=this,u=this._qfDismissCount,e;this.initCortanaEnabledAndRegion();e=i.isBingEnabled;e!=n.isBingEnabled()&&(n.refreshBingEnabledCache(e,t.getMarketForBingAvailability()),t.initScopePrefixes(function(n){return r.getLocString(n)},function(n){return r.getEnUsLocString(n)}),t.scopeListRequiresUpdate=!0);this._queryParamsCache[f.CountryCode]=t.regionCache;t.homeGeographicRegionCache&&t.homeGeographicRegionCache!=t.regionCache&&(this._queryParamsCache[f.HomeGeographicRegion]=t.homeGeographicRegionCache);t.isCortanaEnabledCache&&i.getVcdKeywordsAsync&&t.Promise.safeChain("vcdKeywords",function(){return i.getVcdKeywordsAsync()},function(n){u==r._qfDismissCount&&(r._vcdKeywords=n)});this.enumerateMultiAccountAuthority(u);this.initHeadersOverrides(u);i.changeExplicitDismissMode&&(t.config.keepCortanaOpened||t.getTweakedSetting("keepCortanaOpenedTweak"))&&i.changeExplicitDismissMode(!0)},a.prototype.initCortanaEnabledAndRegion=function(){if(t.qfMode==3)t.isCortanaEnabledCache=!1,t.regionCache=t.homeGeographicRegionCache;else{var n=SearchAppWrapper.CortanaApp;t.isCortanaEnabledCache=n.isCortanaEnabled;t.regionCache=n.region}},a.prototype.enumerateAccountAuthority=function(n){var r=this;t.config.wamSupported&&t.Promise.safeChain("enumerateAccountAuthorityAsync",function(){return i.authenticationManager.enumerateAccountAuthorityAsync()},function(i){var u,f;t.windowsAccountType==0&&(u=i.Windows,t.windowsAccountType=u=="organizations"?1:u=="consumers"?2:3,t.initScopePrefixes(function(n){return r.getLocString(n)},function(n){return r.getEnUsLocString(n)}),t.scopeListRequiresUpdate=!0,t.windowsAccountType!=3&&r._accessTokenManager&&(f=t.accountTypeToAuthType(t.windowsAccountType),r._accessTokenManager.getAccount(f,t.getBingResourceOrScope(f),!1,!0,function(n){return t.windowsIdentity=n&&n.UserName?n.UserName:""},"Windows")));n==r._qfDismissCount&&(u=t.qfMode==3?null:i.Cortana,t.cortanaAccountType=u=="organizations"?1:u=="consumers"?2:3,t.config.useCortanaAccountFor3S&&(t.initScopePrefixes(function(n){return r.getLocString(n)},function(n){return r.getEnUsLocString(n)}),t.scopeListRequiresUpdate=!0));t.isCloudSearchEnabledCache&&t.substrateProvidersEnabled()&&(u=t.getAccountTypeForCloudContent(),u==1?r.tryConnect(1,n,null):u==2&&t.qfMode!=3&&r.tryConnect(0,n,null));t.windowsAccountType==t.cortanaAccountType&&t.windowsAccountType!=3&&r._accessTokenManager&&(f=t.accountTypeToAuthType(t.cortanaAccountType),r._accessTokenManager.getAccount(f,t.getBingResourceOrScope(f),!1,!0,function(n){return t.cortanaIdentity=n&&n.UserName?n.UserName:""},"Cortana"));r.initHeadersOverrides(n)})},a.prototype.selectAccounts=function(n){for(var t,u,i,r,f=0,e=n;f<e.length;f++)t=e[f],t.accountProviderAuthority=="consumers"&&(!i||t.isDefaultAccount)?i=t:t.accountProviderAuthority=="organizations"&&(!r||t.isDefaultAccount)&&(r=t);return u=[],i&&u.push(i),r&&u.push(r),u},a.prototype.getAccountTokens=function(n){for(var i,r=0,u=n;r<u.length;r++)i=u[r],i.accountProviderAuthority=="consumers"?this._accessTokenManager.getAccount(0,t.getBingResourceOrScope(0),!1,!0,function(n){return t.windowsIdentity=n&&n.UserName?n.UserName:""},"Windows",i):i.accountProviderAuthority=="organizations"&&this._accessTokenManager.getAccount(1,t.getBingResourceOrScope(1),!1,!0,function(n){return t.windowsIdentity=n&&n.UserName?n.UserName:""},"Windows",i)},a.prototype.setWindowsAccountType=function(n){for(var f,i=!1,r=!1,u=0,e=n;u<e.length;u++)f=e[u],f.accountProviderAuthority=="consumers"?i=!0:f.accountProviderAuthority=="organizations"&&(r=!0);t.windowsAccountType=i&&r?4:r?1:i?2:3;this.resetScopeList()},a.prototype.setCortanaAccountType=function(){t.qfMode==3?t.cortanaAccountType=3:(t.windowsAccountType==4||t.windowsAccountType==2)&&(t.cortanaAccountType=2);t.config.useCortanaAccountFor3S&&this.resetScopeList()},a.prototype.connectAccounts=function(n,t){for(var i,r=0,u=n;r<u.length;r++)i=u[r],i.accountProviderAuthority=="consumers"?this.tryConnect(0,t,i):i.accountProviderAuthority=="organizations"&&this.tryConnect(1,t,i)},a.prototype.resetScopeList=function(){var n=this;t.initScopePrefixes(function(t){return n.getLocString(t)},function(t){return n.getEnUsLocString(t)});t.scopeListRequiresUpdate=!0},a.prototype.enumerateMultiAccountAuthority=function(n){var r=this;if(t.config.wamSupported){if(!i.authenticationManager.getAllSearchWebAccountsAsync||!t.config.enableMultiAccountSearch){this.enumerateAccountAuthority(n);return}t.Promise.safeChain("getAllSearchWebAccountsAsync",function(){return i.authenticationManager.getAllSearchWebAccountsAsync()},function(i){var u=r.selectAccounts(i);t.windowsAccountType==0&&(r.getAccountTokens(u),r.setWindowsAccountType(u));n==r._qfDismissCount&&r.setCortanaAccountType();t.isCloudSearchEnabledCache&&t.substrateProvidersEnabled()&&r.connectAccounts(u,n);r.initHeadersOverrides(n)})}},a.prototype.dismissCleanup=function(){delete this._queryParamsCache[f.HomeGeographicRegion];t.config.wamSupported||(t.windowsAccountType=0);t.cortanaAccountType=0;t.cortanaIdentity=null;this._queryToIgnoreOnQueryTextChangedEvent=null;this._currentQuery=null;this._vcdKeywords=null;t.regionCache=null;typeof WindowsFeedbackForm!="undefined"&&WindowsFeedbackForm.Remove()},a.prototype.getAccentColor=function(){return this._accentColor},a.prototype.isBitmapInClipboardAvailable=function(){if(!i.getClipboardAvailableFormats)return!1;var t=n.safeExecute(function(){return i.getClipboardAvailableFormats()},"getClipboardAvailableFormats",[]);if(!n.contains(t,"Bitmap"))return!1;try{return i.getClipboardBitmapAsync(),!0}catch(r){return!1}},a.prototype.getBitmapURIFromClipboardAsync=function(r){var u=n.safeExecute(function(){return i.getClipboardAvailableFormats()},"getClipboardAvailableFormats",[]);n.contains(u,"Bitmap")||r(null);t.Promise.safeChain("getClipboardBitmapAsync",function(){return i.getClipboardBitmapAsync()},function(n){return r(URL.createObjectURL(n))},function(){return r(null)})},a.prototype.initHeadersOverrides=function(r){var f=this,u=[],e,o;this._headersCache={};i.systemRAMInMB&&i.systemRAMInMB<=512&&u.push("LowMemoryDevice");u.push("FontV22");u.push("LightAnswers");t.previewPaneAvailable&&u.push("PreviewPaneAvailable");t.isSmallerAnswersUX()&&u.push("SmallerAnswers");u.length>0&&(this._headersCache["X-BM-ClientFeatures"]=u.join());t.qfMode==3&&(this._headersCache["X-Device-isOptin"]="false",this._headersCache["X-Search-CortanaAvailableCapabilities"]="",this._headersCache["X-BM-UserDisplayName"]="",e=i.newTabPage.location,this._headersCache["X-Search-Location"]=e,this._shouldRequestEltoken=!!e,t.cortanaAccountType!=3&&(this._headersCache["X-Search-RPSToken"]="NA",this._headersCache.Authorization="Bearer NA",o=this._headersCache,t.windowsAccountType==2?this._accessTokenManager.getAccount(0,t.getBingResourceOrScope(0),!1,!0,function(n){return o["X-Search-RPSToken"]=n&&n.Token?n.Token:""},"Windows"):t.windowsAccountType==1&&this._accessTokenManager.getAccount(1,t.getBingResourceOrScope(1),!1,!0,function(n){return o.Authorization=n&&n.Token?"Bearer "+n.Token:""},"Windows")));ThresholdUtilities.getCortanaHeaders(function(e){if(e&&r==f._qfDismissCount){t.qfMode!=3&&(f._shouldRequestEltoken=!!e["X-Search-Location"]);var o=e["X-BM-ClientFeatures"];o&&(Array.prototype.push.apply(u,o.split(",")),f._headersCache["X-BM-ClientFeatures"]=u.join());f._safeSearchSetting=e["X-Search-SafeSearch"];f._isEducationEnvironment=e["X-Device-EnableRegulatoryPsm"]=="1";f._isWindowsS=e["X-Device-EnableCPsm"]=="1";f._partnerSearchCode=e["X-Device-PSC"];t.config.cortanaCapabilitiesAvailable?(t.availableCortanaCapabilities=t.isCortanaEnabledCache?n.safeExecute(function(){return i.getCortanaCapabilities()},"getCortanaCapabilities","").split(","):[],t.isCortanaPersonalized=n.contains(t.availableCortanaCapabilities,"Personalization")):(t.availableCortanaCapabilities=[],t.isCortanaPersonalized=!!e["X-Search-RPSToken"]&&t.isCortanaEnabledCache);t.config.wamSupported||(t.isCortanaPersonalized?e["X-Search-RPSToken"]?t.cortanaAccountType=2:e.Authorization&&(t.cortanaAccountType=1):(t.cortanaAccountType=3,e["X-Search-RPSToken"]?t.windowsAccountType=2:e.Authorization&&(t.windowsAccountType=1)));t.substrateProvidersEnabled()||(t.scopeListRequiresUpdate=!0)}})},a.prototype.applyAccentColor=function(t){var u,f="accent-style",r=_ge(f),i;r||(r=_d.createElement("style"),r.setAttribute("id",f),r.type="text/css",u=!0);i=".icon svg { fill: {0} }";i+=".gridLayout .suggestion.sa_hv, .gridLayout .suggestion.sa_hv:hover { border-color: {1}; }";i+=".toggleSwitch input:checked + label::before { background-color: {0}; border-color: {0}; }";n.isHighContrastEnabled()||(i+=".action .annotation, .accentColor, .accentColor:visited { color: {0}; }",i+=".sa_hv, .sa_hv.selectable:active, .sa_hv.selectable:hover, .sa_hv .openPreviewPaneBtn:active { background-color: {1}; }",i+="#root.suggestionHoverStateWide .sa_hv .suggDetailsContainer:hover { background-color: {2}; }",i+=".sa_hv.action .annotation { color: {7}; }",i+="#footer { background-color: {8}; }",i+="#footer:hover { background-color: {9}; }",i+="#footer:active { background-color: {10}; }",i+=".topHitConnectedToGroup:not(.sa_hv):not(.previewPaneOpened) { background: {2}; }",i+="#root .selectedScope { background-color: {3}; }",i+="#root .selectedScope:hover { background-color: {4}; }",i+="#root .selectedScope:active { background-color: {5}; }",i+="#root.wideByDefault .selectedScope { border-color: {0}; }",i+="#startMenu .icon { background-color: {5}; }",i+=".accentButtonBackground { background-color: {6}; }",i+=".accentButtonBackground:focus { background-color: {1}; }",i+=".scopeOptions input[type='button'], .topOptions input[type='button'] { background-color: {0}; border-color: {0} }",i+=".scopeOptions input[type='button']:hover, .topOptions input[type='button']:hover { border-color: {3} }",i+=".hr-expander.selectedExpander .expanderInnerCircle, .hr-expander:hover .expanderInnerCircle { background-color: {1}; border-color: {11} }",i+="#previewContainer .hr-expander.selectedExpander hr, #previewContainer .hr-expander:hover hr { border-color: {1} }");r.innerHTML=n.formatString(i,[t,o(t,.3),o(t,.1),o(t,.4),o(t,.6),o(t,.7),o(t,.15),y(t,35),s(t,.65),s(t,.8),s(t,.9),o(t,0),]);u&&_d.head.appendChild(r)},a.prototype.createGuid=function(){return n.safeExecute(function(){return i.createGuid()},"createGuid","")},a.prototype.getLocString=function(t){for(var i,u,e,o,f=[],r=1;r<arguments.length;r++)f[r-1]=arguments[r];for(u=0,e=this._locStrings;u<e.length;u++)if(o=e[u],i=o[t],i)break;return i||(i=this.getEnUsLocString(t)),i&&f.length>0&&(i=n.formatString(i,f)),i},a.prototype.getEnUsLocString=function(n){for(var u,r,t=0,i=this._enUsLocStrings;t<i.length;t++)if(u=i[t],r=u[n],r)return r;return undefined},a.prototype.getRawImpressionGuid=function(){return this._currentRawImpressionId},a.prototype.getConversationId=function(){return this._currentCVID},a.prototype.getPrivacyNumber=function(){return this._randomPrivacyNumber},a.prototype.getNewConversationId=function(){var t=n.cleanGuid(n.safeExecute(function(){return e.perfMetrics.conversationId},"conversationId"));return t||(SharedLogHelper.LogWarning("getNewConversationId",null,new Error("Client returned null conversation ID")),t=n.cleanGuid(this.createGuid())),t},a.prototype.getNewPrivacyNumber=function(){return Math.floor(Math.random()*Number.MAX_VALUE)},a.prototype.bindQueryChangedOrInitialized=function(n,t){t?this._rawQueryChangedHandlers.push(n):this._queryChangedHandlers.push(n)},a.prototype.bindOnSubmit=function(n){this._onSubmitHandlers.push(n)},a.prototype.bindSearchBoxGlyphIconClick=function(n){this._onSearchBoxGlyphIconClick.push(n)},a.prototype.bindSearchBoxClick=function(n){this._onSearchBoxClick.push(n)},a.prototype.bindButtonRightOfSearchBoxClick=function(n){this._onButtonRightOfSearchBoxClick.push(n)},a.prototype.bindSearchBoxGotFocus=function(n){this._searchBoxGotFocusEventHandlers.push(n)},a.prototype.bindSearchBoxLostFocus=function(n){this._searchBoxLostFocusEventHandlers.push(n)},a.prototype.getModifierKeyState=function(){return this._modifierKeyState},a.prototype.bindAppVisible=function(n){this._appVisibleEventHandlers.push(n)},a.prototype.bindShown=function(n){this._shownEventHandlers.push(n)},a.prototype.bindConversationStart=function(n){this._conversationStartEventHandlers.push(n)},a.prototype.bindDismissed=function(n){this._dismissedEventHandlers.push(n)},a.prototype.bindAppHidden=function(n){this._appHiddenEventHandlers.push(n)},a.prototype.bindKeyDown=function(n){this._keyDownHandlers.push(n)},a.prototype.bindKeyUp=function(n){this._keyUpHandlers.push(n)},a.prototype.bindAccessTokenAvailable=function(n){this._accessTokenAvailableHandlers.push(n)},a.prototype.getQuery=function(){return this.getStructuredQuery(u.getQueryText(),this._previousQuery)},a.prototype.refreshCurrentPane=function(){var n=this._currentQuery?this._currentQuery.originalQuery:"";this.setQuery(n,!1,!0,!1)},a.prototype.updateQueryWithoutRefetching=function(n){t.isNullOrUndefined(n)&&(n=this._currentQuery?this._currentQuery.originalQuery:"");this.setQuery(n,!1,!1,!0)},a.prototype.reformulate=function(n,t,i,r,u){var f={query:n,taskFrame:t,topHitRestriction:i,forceGroupOnTop:r,overrideAction:u};this.setQuery(n||"",!0,!1,!1,f)},a.prototype.setQuery=function(r,f,e,o,s){var h=this,c;if(t.isNullOrUndefined(r))throw new Error("query parameter can't be null");if(!f&&s)throw new Error("Property overrides only allowed on query reformulations");this._queryPropertiesOverrides=s;f||e||(this._queryToIgnoreOnQueryTextChangedEvent=r);n.safeExecute(function(){return u.setQueryText(r,f,h._currentRawImpressionIdCreatedByTheClient?h._currentRawImpressionId:i.impressionId,o)},"setQueryText");c=f&&(this.getQuery().originalQuery==r||t.config.triggerQueryTextChangedEventsOnSetQuery)||e;c&&n.safeExecute(function(){return h.callQueryChangedHandlers({queryText:r,cursorPosition:r.length},e,!1)},"triggerQueryTextChangedEvent")},a.prototype.setAutoCompleteQueryText=function(t){var i=this;n.safeExecute(function(){return u.setAutoCompleteQueryText(t,i._currentRawImpressionId)},"setAutoCompleteQueryText")},a.prototype.manuallyDismissApp=function(){t.config.manuallyDismissApp&&i.setDefaultUriLaunchPolicy&&!t.isMobileCache&&SearchAppWrapper.CortanaApp.dismissApp()},a.prototype.launchUrl=function(n,u,f){var o=this,e=function(n){n?(u&&u(),o.manuallyDismissApp()):f&&f()};t.isMobileCache?t.Promise.safeChain("launchUrl",function(){return r.launchUriAsync(n)},e,f):i.setDefaultUriLaunchPolicy?t.Promise.safeChain("launchUrl",function(){var t=r.createUriLaunchOptions();return t.launchPolicy=2,r.launchUriAsync(n,t)},e,f):t.Promise.safeChain("launchUrlTH1",function(){return r.launchUriAsync("microsoft-edge:"+n)},e,f)},a.prototype.launchOutlook=function(n,i,u){var f=this;t.Promise.safeChain("launchOutlook",function(){return r.launchEmailInOutlookNativeAsync(n)},function(n){n?(i&&i(),f.manuallyDismissApp()):u&&u()},u)},a.prototype.populateTaskbarPinnedItemsAsync=function(){var n=this,i=this._qfDismissCount;t.config.pinnedToTaskBarSignalEnabled&&!t.isMobileCache&&e.deviceSearch.getTaskbarPinnedItemsAsync&&t.Promise.safeChain("pinnedTaskBarItems",function(){return e.deviceSearch.getTaskbarPinnedItemsAsync()},function(t){i==n._qfDismissCount&&t&&t.forEach(function(t){return n._pinnedApps[t]=!0})})},a.prototype.removeItemFromPinnedToTaskbar=function(n){this._pinnedApps[n]=!1},a.prototype.addItemToPinnedToTaskbar=function(n){this._pinnedApps[n]=!0},a.prototype.cleanTaskBarPinnedItems=function(){this._pinnedApps={}},a.prototype.isPinnedToTaskbar=function(n){return this._pinnedApps[n]},a.prototype.launchSearchInFileExplorer=function(t){i.launcher.launchExplorerSearch?n.safeExecute(function(){return i.launcher.launchExplorerSearch("query="+encodeURIComponent(t)+"&crumb=kind:docs&crumb=location:")},"launchExplorerSearch"):n.safeExecute(function(){return i.launcher.launchSearchInApp(1,t)},"launchSearchInApp")},a.prototype.matchesVcd=function(n){var t,r,i,u,f,e;if(this._vcdKeywords&&n&&(t=c(n),t))for(r in this._vcdKeywords)if(this._vcdKeywords.hasOwnProperty(r)&&(i=c(r),i&&(u=t.indexOf(i),u>=0&&((f=this._vcdKeywords[r],f&1)||f&2&&u==0||f&4&&(u==t.length-i.length||(e=t.lastIndexOf(i),e==t.length-i.length))))))return!0;return!1},a.prototype.isRequestFocusAvailable=function(){return!!u.requestFocus},a.prototype.setFocusInSearchBox=function(t){if(this.isRequestFocusAvailable()){n.safeExecute(function(){return u.requestFocus()},"requestFocus",null,t);var i=n.getCurrentActiveElement();i&&i.blur()}},a.prototype.getFeatureEnabled=function(t){var r={validFeature:!1,featureEnabled:!1};return i.getFeatureEnabled?n.safeExecute(function(){return i.getFeatureEnabled(t)},"getFeatureEnabled",r,t):r},a.prototype.getFeatureDWORD=function(t){var r={validFeature:!1,featureValue:0};return i.getFeatureDWORD?n.safeExecute(function(){return i.getFeatureDWORD(t)},"getFeatureDWORD",r,t):r},a.prototype.getFeatureString=function(t){var r={validFeature:!1,featureValue:""};return i.getFeatureString?n.safeExecute(function(){return i.getFeatureString(t)},"getFeatureString",r,t):r},a.prototype.launchInApp=function(i,r,f){this.updateQueryWithoutRefetching(r);n.safeExecute(f,i);t.isMobileCache&&u.requestUnfocus&&n.safeExecute(function(){return u.requestUnfocus()},"requestUnfocus",null,i)},a.prototype.launchVoiceFlow=function(n){var t=this;this.launchInApp("launchVoiceFlow",n,function(){return r.launchRAFAsync(n,t.getFormCode(),t.getInstrumentationParameters())})},a.prototype.launchSearch=function(n,u,f){var e=this;f?this.launchVoiceFlow(n):t.isMobileCache?this.launchInApp("launchSearch",n,function(){var t=r.createSearchLaunchOptions();t.searchQuery=n;var i=u.indexOf("/search"),f=u.indexOf("/",u.indexOf("//")+2),e=f==i?"":u.substring(f+1,i);e&&(t.pivot=e);t.mode=1;t.uriContext=u.substr(u.indexOf("&")+1);r.launchSearchAsync(t)}):i.setDefaultUriLaunchPolicy?t.Promise.safeChain("launchSearch",function(){return r.launchUriAsync(u)},function(n){n&&e.manuallyDismissApp()}):t.Promise.safeChain("launchSearchTH1",function(){return r.launchUriAsync("microsoft-edge:"+u)})},a.prototype.launchCat1=function(n,u,f){var s=this,o=p[u],e;o?this.launchInApp("launch"+o,n,function(){return i.launchExperienceByName(o,null)}):(e=w[u],e?t.Promise.safeChain("launchCat1 "+e,function(){return r.launchUriAsync(e)},function(n){n&&s.manuallyDismissApp()}):this.launchInApp("launchCat1",n,function(){return r.launchCat1Async(n,f,s.getInstrumentationParameters())}))},a.prototype.launchCat2or3a=function(n,t){var i=this;this.launchInApp("launchCat2",n,function(){return r.launchCat2Async(n,i.getFormCode(),t,i.getInstrumentationParameters())})},a.prototype.launchStorePdp=function(i){var u=this,f="ms-windows-store:pdp?ProductId="+n.encodeQueryParameter(i)+"&ocid="+n.encodeQueryParameter(t.config.storeHandoffTag);t.Promise.safeChain("launchStorePdp",function(){return r.launchUriAsync(f)},function(n){n&&u.manuallyDismissApp()})},a.prototype.launchStoreSearch=function(i){var u=this,f="ms-windows-store:search?query="+n.encodeQueryParameter(i)+"&ocid="+n.encodeQueryParameter(t.config.storeHandoffTag)+"&type=apps";t.Promise.safeChain("launchStoreSearch",function(){return r.launchUriAsync(f)},function(n){n&&u.manuallyDismissApp()})},a.prototype.launchFolder=function(t){var i=this;n.safeExecute(function(){return r.startLaunchFolder(t)},"launchFolder");sb_st(function(){return i.manuallyDismissApp()},0)},a.prototype.launchWindowsCortanaSettings=function(){this.launchUrl("ms-settings:cortana")},a.prototype.launchWindowsIndexingOptions=function(){t.LocalDataProvider.launchIndexingOptions(this,!1)},a.prototype.launchCortanaSignIn=function(){this.launchUrl("ms-cortana://CapabilitiesPrompt/?RequestedCapabilities=Personalization")},a.prototype.launchCortanaHome=function(){this.launchUrl("ms-cortana://StartMode=Coobe")},a.prototype.launchCortanaNotebook=function(){this.launchUrl("ms-cortana://StartMode=Notebook")},a.prototype.launchCortanaDevices=function(){this.launchUrl("ms-cortana://StartMode=Devices")},a.prototype.launchWindowsAccountSettings=function(){this.launchUrl("ms-settings:emailandaccounts")},a.prototype.getErrorCodeToIgnoreOnLaunch=function(n){return t.isIndexerBasedDataSource(n)||n=="PT"?-2147467263:undefined},a.prototype.launchDeviceItem=function(i,u){var s=this,f=i.id,e=u,o;t.localDataSourceMayContainPII(u)||(e+="\n"+f);f.startsWith("shell:")?n.safeExecute(function(){return r.startLaunchFolder(f)},"launchDeviceItem",null,e):(o=i.originalDeviceItem||i,t.Promise.safeChain("launchDeviceItem",function(){return r.launchSearchItemAsync(o)},function(){return s.manuallyDismissApp()},null,null,e,this.getErrorCodeToIgnoreOnLaunch(u)))},a.prototype.launchAppItem=function(i,u,f){var h=this,e=i.id,o=u+"\n"+e,s;f&&o+"\n"+f;e.startsWith("shell:")?n.safeExecute(function(){return r.startLaunchFolder(e)},"launchAppItem",null,o):(s=i.originalDeviceItem||i,t.Promise.safeChain("launchAppItem",function(){var n;return f&&(n=r.createAppLaunchOptions(),n.appContext=f),r.launchSearchItemAsync(s,n)},function(){return h.manuallyDismissApp()},null,null,o,this.getErrorCodeToIgnoreOnLaunch(u)))},a.prototype.launchWebContent=function(n,t,i){this.launchInApp("launchWebContent",t,function(){var t=r.createWebContentLaunchOptions();t.uri=n;i&&t.setAuthorization("Bearer",i);r.launchWebContent(t)})},a.prototype.getCustomUrlParameters=function(i){var r=Object.assign({},this._queryParamsCache),u=i.scope;return u==t.Scope.All?delete r[f.Scope]:r[f.Scope]=t.Scope[u].toLowerCase(),t.searchHistoryAllowed()||(r[n.Service.QueryParams.NoHistory]="1"),r},a.prototype.getCustomHeaders=function(){return Object.assign({},this._headersCache)},a.prototype.reloadWebView=function(n){var r=this;n?t.Promise.safeChain("repopulateAppCacheAsync",function(){return i.repopulateAppCacheAsync()},function(){return r.reloadWebView(!1)}):t.Promise.safeChain("reloadWebViewAsync",function(){return i.reloadWebViewAsync()})},a.prototype.throwIfResourcesMissing=function(){var t=_ge("cssCanary"),n=_w.getComputedStyle(t).fontFamily;if(n!="CANARY"&&n!='"CANARY"')throw new Error("Missing CSS Bundle");},a.prototype.getFormCode=function(){if(t.qfMode==3)switch(i.newTabPage.pageInfo.pageType){case 2:return"TSPEAA";case 3:return"TNTEAA";default:return"TNTAAA"}return"WNSGPH"},a.prototype.getRegion=function(){return t.regionCache},a.prototype.getLanguage=function(){return t.uiLanguageCache},a.prototype.dataSourceDependencies=function(t){return t==n.WebDataSource?["OSTMA","QS"]:[]},a.prototype.getPaneCloseCount=function(){return this._paneCloseCount},a.prototype.hasFallbackHappened=function(){return this._hasFallbackHappened},a.prototype.getSafeSearchSetting=function(){return this._safeSearchSetting},a.prototype.isEducationEnvironment=function(){return this._isEducationEnvironment},a.prototype.isWindowsS=function(){return this._isWindowsS},a.prototype.getPartnerSearchCode=function(){return this._partnerSearchCode},a.prototype.getMSNRefIg=function(){return t.qfMode==3?i.newTabPage.pageInfo.pageId:null},a.prototype.setSearchBoxGlyphIcon=function(t){var i,r,f;u.setSearchBoxGlyphIcon&&(t?(i=t.content||"",i.startsWith("&#x")&&(r=parseInt(i.substr(3),16),i=r?String.fromCharCode(r):""),f=t.type==2?"/Assets/Fonts/CortMDL2.ttf#Cortana MDL2 Assets":"",n.safeExecute(function(){return u.setSearchBoxGlyphIcon(i,f)},"setSearchBoxGlyphIcon custom")):n.safeExecute(function(){return u.setSearchBoxGlyphIcon("","")},"setSearchBoxGlyphIcon default"))},a.prototype.promptAutheticateDialog=function(i,r,u,f){var e=this,o=function(r){var o=!!r;i==1?t.isSubstrateO365AccountConnected=o:t.isSubstrateOutlookAccountConnected=o;o?(u(),e._accessTokenAvailableHandlers.forEach(function(t){return n.safeExecute(function(){return t(i)},"promptAccessTokenAvailable",null,i.toString())})):f()};this._accessTokenManager.getAccount(i,r,!1,!1,o,t.getAuthAccountForCloudContent())},a.prototype.adjustHeightWithoffset=function(){},a.prototype.adjustHeight=function(){var u=this,n,r;(t.qfMode==3||t.qfMode==5)&&i.setWebViewHeight&&(this._pendingAdjustHeightTimer&&(sb_ct(this._pendingAdjustHeightTimer),this._pendingAdjustHeightTimer=null),t.config.th&&ClientTestHooks.isTesthookParamSet("searchbox")&&(this._root.style.height=""),n=this._feedbackFormIsVisible?v:this._root.offsetHeight,r=function(){i.isCenterScreen&&i.setCenterScreenAcrylicBackgroundHeight(n+2);i.setWebViewHeight(n);u._currentPaneHeight=n;u._pendingAdjustHeightTimer=null},!t.config.paneResizeDelay||n>=this._currentPaneHeight?r():this._pendingAdjustHeightTimer=sb_st(r,t.config.paneResizeDelay))},a.prototype.isClientLocationAvailable=function(){return this._shouldRequestEltoken||!!this._elToken},a}();t.Host=b})(t=n.WSB||(n.WSB={}))})(AutoSuggest||(AutoSuggest={}))